<section class="relative mt-20 pt-12 lg:pt-12 border-t border-gray-700 text-gray-300" data-projects-section
    style="background:#232323; box-shadow: 0 0 0 100vmax #232323; clip-path: inset(0 -100vmax);">

    <div class="relative z-10 text-center mb-8">
        <h2 id="services-heading"
            class="font-montserrat text-3xl md:text-4xl lg:text-4xl font-extrabold text-gray-200 mb-2 transition-transform transition-opacity duration-[880ms] ease-[cubic-bezier(.2,.6,.2,1)] opacity-0 translate-y-3 will-change-transform will-change-opacity"
            data-delay="0">
            НАШИ ПРОЕКТЫ
        </h2>
    </div>

    <div class="relative z-10 pt-5 pb-16 container-custom">
        <div class="mb-15 grid grid-cols-1 md:grid-cols-1 lg:grid-cols-2 gap-14">
            <article
                class="group opacity-0 translate-y-6 md:translate-y-8 scale-[.985] blur-[2px] will-change-transform will-change-opacity will-change-filter transition-[transform,opacity,filter] duration-[1000ms] md:duration-[1100ms] ease-[cubic-bezier(.2,.6,.2,1)]"
                data-delay="0">
                <a href="{{ route('projects.show', 'galereya_vkusa') }}"
                    class="block relative overflow-hidden rounded-none shadow-sm h-[26rem] sm:h-[28rem] md:h-[32rem]">
                    <img src="{{ asset('images/our_projects/pekarnya/fasade_large.jpg') }}"
                        alt="Реконструкция офиса «Альфа»"
                        class="w-full h-full object-cover transition-[transform,opacity,filter] duration-[1000ms] md:duration-[1100ms] ease-[cubic-bezier(.2,.6,.2,1)] translate-y-2 opacity-0 filter grayscale saturate-0 brightness-95 group-[.revealed]:translate-y-0 group-[.revealed]:opacity-100 group-hover:grayscale-0 group-hover:saturate-100 group-hover:brightness-100"
                        loading="eager" fetchpriority="high" decoding="async" style="will-change: filter;">
                    <div
                        class="project-badges absolute inset-x-0 bottom-3 flex flex-wrap gap-2 px-3 justify-start opacity-0 translate-y-2 pointer-events-none transition-all duration-500 ease-out group-hover:opacity-100 group-hover:translate-y-0">
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm">Электромонтаж</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-100">Проектирование</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-150">Интернет</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-200">Видеонаблюдение</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-250">Пожарная
                            автоматика</span>
                    </div>
                </a>
                <div class="mt-4">
                    <h3
                        class="text-lg md:text-2xl font-semibold text-gray-200 transition-colors duration-500 group-hover:text-blue-500">
                        ГАЛЕРЕЯ ВКУСА</h3>
                    <p class="text-gray-200 mt-3 text-sm md:text-base">
                        Пекарня, кондитерская и кафе.
                    </p>
                </div>
            </article>

            <article
                class="group opacity-0 translate-y-6 md:translate-y-8 scale-[.985] blur-[2px] will-change-transform will-change-opacity will-change-filter transition-[transform,opacity,filter] duration-[1000ms] md:duration-[1100ms] ease-[cubic-bezier(.2,.6,.2,1)]"
                data-delay="240">
                <a href="{{ route('projects.show', 'nesk') }}"
                    class="block relative overflow-hidden rounded-none shadow-sm h-[26rem] sm:h-[28rem] md:h-[32rem]">
                    <img src="{{ asset('images/our_projects/nesk/1.jpg') }}" alt="Реконструкция офиса «Альфа»"
                        class="w-full h-full object-cover transition-[transform,opacity,filter] duration-[1000ms] md:duration-[1100ms] ease-[cubic-bezier(.2,.6,.2,1)] translate-y-2 opacity-0 filter grayscale saturate-0 brightness-95 group-[.revealed]:translate-y-0 group-[.revealed]:opacity-100 group-hover:grayscale-0 group-hover:saturate-100 group-hover:brightness-100"
                        loading="eager" fetchpriority="high" decoding="async"
                        style="object-position:10% 10%; will-change: filter;">
                    <div
                        class="project-badges absolute inset-x-0 bottom-3 flex flex-wrap gap-2 px-3 justify-start opacity-0 translate-y-2 pointer-events-none transition-all duration-500 ease-out group-hover:opacity-100 group-hover:translate-y-0">
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm">Электромонтаж</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-100">Проектирование</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-150">Сети</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-150">Охранно-пожарная
                            сигнализация</span>
                    </div>
                </a>
                <div class="mt-4">
                    <h3
                        class="text-lg md:text-2xl font-semibold text-gray-200 transition-colors duration-500 group-hover:text-blue-500">
                        НЕЗАВИСИМАЯ ЭНЕРГОСБЫТОВАЯ КОМПАНИЯ "НЭСК"</h3>
                    <p class="text-gray-200 mt-3 text-sm md:text-base">
                        Офис компании, занимающейся поставками электроэнергии.
                    </p>
                </div>
            </article>

            <article
                class="group opacity-0 translate-y-6 md:translate-y-8 scale-[.985] blur-[2px] will-change-transform will-change-opacity will-change-filter transition-[transform,opacity,filter] duration-[1000ms] md:duration-[1100ms] ease-[cubic-bezier(.2,.6,.2,1)]"
                data-delay="240">
                <a href="{{ route('projects.show', 'dynasty') }}"
                    class="block relative overflow-hidden rounded-none shadow-sm h-[26rem] sm:h-[28rem] md:h-[32rem]">
                    <img src="{{ asset('/images/our_projects/caplya/1.jpg') }}" alt="Реконструкция офиса «Альфа»"
                        class="w-full h-full object-cover transition-[transform,opacity,filter] duration-[1000ms] md:duration-[1100ms] ease-[cubic-bezier(.2,.6,.2,1)] translate-y-2 opacity-0 filter grayscale saturate-0 brightness-95 group-[.revealed]:translate-y-0 group-[.revealed]:opacity-100 group-hover:grayscale-0 group-hover:saturate-100 group-hover:brightness-100"
                        loading="eager" fetchpriority="high" decoding="async"
                        style="object-position:10% 70%; will-change: filter;">
                    <div
                        class="project-badges absolute inset-x-0 bottom-3 flex flex-wrap gap-2 px-3 justify-start opacity-0 translate-y-2 pointer-events-none transition-all duration-500 ease-out group-hover:opacity-100 group-hover:translate-y-0">
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm">Электромонтаж</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-100">Проектирование</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-150">Сети</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-150">Пожарная
                            автоматика</span>
                    </div>
                </a>
                <div class="mt-4">
                    <h3
                        class="text-lg md:text-2xl font-semibold text-gray-200 transition-colors duration-500 group-hover:text-blue-500">
                        ДИНАСТИЯ</h3>
                    <p class="text-gray-200 mt-3 text-sm md:text-base">
                        Ресторанно-гостиничный комплекс.
                    </p>
                </div>
            </article>

            <article
                class="group opacity-0 translate-y-6 md:translate-y-8 scale-[.985] blur-[2px] will-change-transform will-change-opacity will-change-filter transition-[transform,opacity,filter] duration-[1000ms] md:duration-[1100ms] ease-[cubic-bezier(.2,.6,.2,1)]"
                data-delay="240">
                <a href="{{ route('projects.show', 'kfh') }}"
                    class="block relative overflow-hidden rounded-none shadow-sm h-[26rem] sm:h-[28rem] md:h-[32rem]">
                    <img src="{{ asset('/images/our_projects/kfh_loza/1.jpg') }}" alt="Реконструкция офиса «Альфа»"
                        class="w-full h-full object-cover transition-[transform,opacity,filter] duration-[1000ms] md:duration-[1100ms] ease-[cubic-bezier(.2,.6,.2,1)] translate-y-2 opacity-0 filter grayscale saturate-0 brightness-95 group-[.revealed]:translate-y-0 group-[.revealed]:opacity-100 group-hover:grayscale-0 group-hover:saturate-100 group-hover:brightness-100"
                        loading="eager" fetchpriority="high" decoding="async"
                        style="object-position:10% 40%; will-change: filter;">
                    <div
                        class="project-badges absolute inset-x-0 bottom-3 flex flex-wrap gap-2 px-3 justify-start opacity-0 translate-y-2 pointer-events-none transition-all duration-500 ease-out group-hover:opacity-100 group-hover:translate-y-0">
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm">Монтаж</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-100">Проектирование</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-150">Сети</span>
                    </div>
                </a>
                <div class="mt-4">
                    <h3
                        class="text-lg md:text-2xl font-semibold text-gray-200 transition-colors duration-500 group-hover:text-blue-500">
                        КФХ</h3>
                    <p class="text-gray-200 mt-3 text-sm md:text-base">
                        Крестьянско-фермерское хозяйство.
                    </p>
                </div>
            </article>
            {{-- СОШ №1 --}}
            <article
                class="group opacity-0 translate-y-6 md:translate-y-8 scale-[.985] blur-[2px] will-change-transform will-change-opacity will-change-filter transition-[transform,opacity,filter] duration-[1000ms] md:duration-[1100ms] ease-[cubic-bezier(.2,.6,.2,1)]"
                data-delay="240">
                <a href="{{ route('projects.show', 'sosh_1') }}"
                    class="block relative overflow-hidden rounded-none shadow-sm h-[26rem] sm:h-[28rem] md:h-[32rem]">
                    <img src="{{ asset('/images/our_projects/SOSH_1/СОШ_1.jpeg') }}" alt="Строительство СОШ №1"
                        class="transform scale-[2.0] w-full h-full object-cover transition-[transform,opacity,filter] duration-[1000ms] md:duration-[1100ms] ease-[cubic-bezier(.2,.6,.2,1)] translate-y-2 opacity-0 filter grayscale saturate-0 brightness-95 group-[.revealed]:translate-y-0 group-[.revealed]:opacity-100 group-hover:grayscale-0 group-hover:saturate-100 group-hover:brightness-100"
                        loading="eager" fetchpriority="high" decoding="async"
                        style="object-position:100% 0%; will-change: filter;">
                    <div
                        class="project-badges absolute inset-x-0 bottom-3 flex flex-wrap gap-2 px-3 justify-start opacity-0 translate-y-2 pointer-events-none transition-all duration-500 ease-out group-hover:opacity-100 group-hover:translate-y-0">
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm">Электроснабжение</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-100">Внутренние
                            электрические сети</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-150">Наружное
                            и внутреннее освещение</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-150">Электротехнические
                            испытания</span>
                    </div>
                </a>
                <div class="mt-4">
                    <h3
                        class="text-lg md:text-2xl font-semibold text-gray-200 transition-colors duration-500 group-hover:text-blue-500">
                        МАОУ СОШ № 1</h3>
                    <p class="text-gray-200 mt-3 text-sm md:text-base">
                        Муниципальное автономное общеобразовательно учреждение средняя общеобразовательная школа № 1
                        имени А. Ф. Крамаренко.
                    </p>
                </div>
            </article>

            {{-- СШОР Водных видов спорта --}}
            <article
                class="group opacity-0 translate-y-6 md:translate-y-8 scale-[.985] blur-[2px] will-change-transform will-change-opacity will-change-filter transition-[transform,opacity,filter] duration-[1000ms] md:duration-[1100ms] ease-[cubic-bezier(.2,.6,.2,1)]"
                data-delay="240">
                <a href="{{ route('projects.show', 'shor_vvs') }}"
                    class="block relative overflow-hidden rounded-none shadow-sm h-[26rem] sm:h-[28rem] md:h-[32rem]">
                    <img src="{{ asset('/images/our_projects/shor_vodnyi/1.jpg') }}" alt="Строительство СОШ №1"
                        class="w-full h-full object-cover transition-[transform,opacity,filter] duration-[1000ms] md:duration-[1100ms] ease-[cubic-bezier(.2,.6,.2,1)] translate-y-2 opacity-0 filter grayscale saturate-0 brightness-95 group-[.revealed]:translate-y-0 group-[.revealed]:opacity-100 group-hover:grayscale-0 group-hover:saturate-100 group-hover:brightness-100"
                        loading="eager" fetchpriority="high" decoding="async"
                        style="object-position:0% 30%; will-change: filter;">
                    <div
                        class="project-badges absolute inset-x-0 bottom-3 flex flex-wrap gap-2 px-3 justify-start opacity-0 translate-y-2 pointer-events-none transition-all duration-500 ease-out group-hover:opacity-100 group-hover:translate-y-0">
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm">Электроснабжение</span>

                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-150">Наружное
                            и внутреннее освещение</span>

                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-150">Видеонаблюдение</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-150">Локальные
                            сети</span>
                        <span
                            class="bg-black/60 text-white text-xs md:text-sm px-2.5 py-1 rounded-full border border-white/10 shadow-sm backdrop-blur-sm delay-150">Пожарная
                            сигнализация</span>
                    </div>

                </a>
                <div class="mt-4">
                    <h3
                        class="text-lg md:text-2xl font-semibold text-gray-200 transition-colors duration-500 group-hover:text-blue-500">
                        ГБУ ДО КК "СШОР ВВС"</h3>
                    <p class="text-gray-200 mt-3 text-sm md:text-base">
                        Государственное бюджетное образовательное учреждение дополнительного образования
                        "Специальная школа олимпийского резерва ВВС".
                    </p>
                </div>
            </article>
        </div>
        {{-- Добавлено: ссылка "Посмотреть больше проектов" --}}
        <div class="mt-8">
            <a href="{{ route('projects.index') }}"
                class="projects-more-link font-monserrat block w-full py-2 font-semibold text-start text-2xl md:text-3xl lg:text-4xl text-gray-200 border-b-2 border-white/70 rounded-none transition-colors duration-300 hover:text-blue-500 hover:border-blue-500 flex items-center justify-between">
                <span>БОЛЬШЕ ПРОЕКТОВ</span>
                <svg xmlns="http://www.w3.org/2000/svg"
                    class="ml-4 flex-shrink-0 w-10 h-10 md:w-15 md:h-15 project-arrow" viewBox="0 0 512 512"
                    aria-hidden="true" focusable="false">
                    <path fill="none" stroke="currentColor" stroke-linecap="square" stroke-miterlimit="10"
                        stroke-width="60" d="M268 112l144 144-144 144M392 256H100" />
                </svg>
            </a>
        </div>
    </div>
</section>

<style>
    /* Предотвращаем горизонтальный скролл у full-bleed секции без влияния на контент */
    [data-projects-section] {
        overflow-x: hidden;
    }

    /* Support check (escaped for Blade) */
    @@supports (overflow: clip) {
        [data-projects-section] {
            overflow-x: clip;
        }
    }

    /* На мобильных/планшетах обеспечиваем плавность смены фильтров и цвета заголовка (активная карточка в JS) */
    @media (hover: none) and (pointer: coarse) {
        [data-projects-section] article.group img {
            transition: filter 900ms cubic-bezier(.2, .6, .2, 1);
        }

        [data-projects-section] article.group h3 {
            transition: color 500ms cubic-bezier(.2, .6, .2, 1);
        }

        /* Показываем бейджи активной карточки на тач-устройствах */
        [data-projects-section] article.group.card-active .project-badges {
            opacity: 1 !important;
            transform: translateY(0) !important;
        }

        [data-projects-section] article.group.card-active .project-badges span {
            transition: opacity 400ms ease, transform 400ms ease;
        }

        /* Дополнительные отступы маркеров от краёв изображения на тач-устройствах */
        [data-projects-section] .project-badges {
            left: 0px;
            /* небольшой внутренний отступ слева */
            right: 0px;
            /* небольшой внутренний отступ справа */
            bottom: 20px;
            /* чуть выше от нижнего края */
        }

        /* Плавное покадровое (stagger) появление бейджей */
        [data-projects-section] .project-badges span {
            opacity: 0;
            transform: translateY(6px);
            transition: opacity .5s cubic-bezier(.2, .7, .2, 1), transform .5s cubic-bezier(.2, .7, .2, 1);
        }

        [data-projects-section] article.group.card-active .project-badges span {
            opacity: 1;
            transform: translateY(0);
        }

        /* Учитываем уже заданные delay-* классы Tailwind для каскада */
    }

    /* Кнопка "Больше проектов" */
    /* Поворот и анимация иконки у ссылки "БОЛЬШЕ ПРОЕКТОВ" */
    .project-arrow {
        transform-origin: center;
        transform-box: fill-box;
        transform: rotate(45deg);
        /* начальное положение 45° */
        transition: transform 320ms cubic-bezier(.2, .7, .2, 1);
        will-change: transform;
    }

    .projects-more-link:hover .project-arrow,
    .projects-more-link:focus .project-arrow,
    .projects-more-link:focus-visible .project-arrow {
        transform: rotate(0deg);
        /* при hover — повернуть на -45° относительно начального (45° → 0°) */
    }

    @media (prefers-reduced-motion: reduce) {
        .project-arrow {
            transition: none;
        }
    }
</style>

<script>
    (function() {
        const section = document.querySelector('[data-projects-section]');
        if (!section) return;

        const reduceMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        const items = Array.from(section.querySelectorAll('article.group'));
        const isTouch = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);
        const heading = section.querySelector('#services-heading');
        if (!items.length) return;

        const showInstant = (el) => {
            el.classList.remove('opacity-0', 'translate-y-6', 'translate-y-8', 'md:translate-y-10',
                'scale-[.98]', 'blur-[2px]');
            el.classList.add('opacity-100', 'translate-y-0');
        };

        if (reduceMotion) {
            items.forEach(showInstant);
            if (heading) showInstant(heading);
            return;
        }

        // Ensure initial state
        items.forEach((el) => {
            if (!el.classList.contains('opacity-0')) {
                el.classList.add('opacity-0');
            }
            if (!el.classList.contains('translate-y-6')) {
                el.classList.add('translate-y-6');
            }
            el.classList.add('scale-[.985]', 'blur-[2px]');
        });
        if (heading) {
            heading.classList.add('opacity-0', 'translate-y-4');
        }

        const observer = new IntersectionObserver((entries, obs) => {
            entries.forEach((entry) => {
                if (entry.isIntersecting) {
                    const el = entry.target;
                    const delay = parseInt(el.getAttribute('data-delay') || '0', 10);
                    el.style.transitionDelay = delay + 'ms';
                    // trigger
                    requestAnimationFrame(() => {
                        el.classList.remove('opacity-0', 'translate-y-6', 'translate-y-8',
                            'md:translate-y-10', 'scale-[.98]', 'blur-[2px]');
                        el.classList.add('opacity-100', 'translate-y-0');
                        // For images to animate with group-[.revealed] selectors
                        if (el.classList.contains('group')) {
                            el.classList.add('revealed');
                        }
                    });
                    obs.unobserve(el);
                }
            });
        }, {
            threshold: 0.12
        });

        items.forEach((el) => observer.observe(el));
        if (heading) observer.observe(heading);

        // Только для мобильных/планшетов: раскрашиваем в цвет только «текущую» карточку (ближайшую к центру экрана)
        if (isTouch) {
            const updateActive = () => {
                const vh = window.innerHeight || document.documentElement.clientHeight;
                let bestEl = null;
                let bestDist = Infinity;

                items.forEach((el) => {
                    const rect = el.getBoundingClientRect();
                    const visible = rect.bottom > 0 && rect.top < vh;
                    if (!visible) return;
                    const center = rect.top + rect.height / 2;
                    const dist = Math.abs(center - vh / 2);
                    if (dist < bestDist) {
                        bestDist = dist;
                        bestEl = el;
                    }
                });

                items.forEach((el) => {
                    const img = el.querySelector('img');
                    const title = el.querySelector('h3');
                    const badges = el.querySelector('.project-badges');
                    const isActive = el === bestEl;

                    el.classList.toggle('card-active', isActive);

                    if (img) {
                        if (isActive) {
                            img.classList.remove('grayscale', 'saturate-0', 'brightness-95');
                            img.classList.add('grayscale-0', 'saturate-100', 'brightness-100');
                        } else {
                            img.classList.add('grayscale', 'saturate-0', 'brightness-95');
                            img.classList.remove('grayscale-0', 'saturate-100', 'brightness-100');
                        }
                    }
                    if (title) {
                        if (isActive) {
                            title.classList.remove('text-gray-200');
                            title.classList.add('text-blue-500');
                        } else {
                            title.classList.add('text-gray-200');
                            title.classList.remove('text-blue-500');
                        }
                    }
                    // Больше не управляем opacity классами напрямую: анимация через CSS (card-active)
                });
            };

            const activeObs = new IntersectionObserver(() => updateActive(), {
                threshold: [0, 0.25, 0.5, 0.75, 1]
            });
            items.forEach((el) => activeObs.observe(el));
            window.addEventListener('scroll', updateActive, {
                passive: true
            });
            window.addEventListener('resize', updateActive);
            updateActive();
        }
    })();
</script>
